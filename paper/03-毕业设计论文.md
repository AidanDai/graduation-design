# 智能失物招领系统的设计与部分实现

# 摘要

智能失物招领系统是基于当下传统失物招领平台不足而建立的一个依靠计算机技术、控制理论、网络通信技术、机械电子技术的智能的失物招领系统。致力于解决在人口密度大、人群活动频繁的环境下人们小件生活物品遗失的找回问题，通过本文设计出的智能失物箱从而统解决传统失物招领过程中的工作效率低下、找回率低、保密性差、管理分散等问题。本系统首先通过智能失物招领箱采集失物的图片信息，在借助于网络通信技术将失物的图片信息同步到本系统的基础数据平台，最后在互联网利用失物的图片信息构建一个失物验证系统，从而达到失物不出失物箱但能认领的过程。整个系统采用 B/S 架构，由智能失物招领箱、失物招领基础数据平台、失物招领管理平台以及失物认领平台组成；智能失物招领箱是基于 Raspberry Pi 3B 构建的触屏智能化终端设备，失物招领基础数据平台是以非关系型 MongoDB 建立的网路数据库系统，失物招领管理平台以及失物认领平台是利用 Node.js 开发的网站管理平台。

本系统能较好的解决失物招领过程中的信息孤岛的缺陷，提高了失物招领的工作效率，减少人们的直接经济损失。也尽可能的杜绝了在传统失物招领过程中的资源浪费问题。

# 关键词

失物招领 失物招领箱 智能 互联网 系统

# abstact

# 目录

[TOC]

# 第一章 1 绪论

## 1.1 论文研究的背景和意义

随着计算机技术、数据处理技术、控制理论、传感器技术、网络通信技术、电力电子技术的迅猛发展和提高，传统电气设备已经走向的智能化[^1]。随着智能设备在生活中的广泛应用，我们已经切实体会到了智能设备的魅力，从解决个人问题到解决家庭问题，甚至到解决群体问题，智能设备一次次的证明了自己，未来必然成为人们生活不可或缺的一部分。又加之互联网是一个虚拟的网络世界，当智能设备与互联网这个巨大平台结合起来，可想而知人们的生活将会更加丰富多彩。

设备智能化是一种理念 、一种方法 、一个发展和进步的过程 , 其目的是使设备通过人工智能的部分或全部功能,尤其是应用现代计算机和网络技术 ,使产品达到最佳工况[^2][^3]。而我们更应该充分利用现在的科技水平，更加充分的去发掘智能设备给生活带来的便利，让它更好的服务于我们的生活。多年来，失物招领工作一直面临着工作效率低下、找回率低、保密性差、管理分散等问题；而且随着生活水平的发展，人们的各种便携式不断增多，失物招领面临着更大的挑战。面对上述现状，如何妥善管理这些失物、做好失物招领工作,已经成为社会亟待解决的问题。此外,失物招领工作的根本就是要尽一切可能找到失主。一般情况下，失物招领工作应该包括失物接收、失物招领和失物认领 3 个主要环节。以往都是由人工完成，现在为了解决工作效率、找回率、保密性、管理等问题，人们应该尝试利用智能设备去解决以往有人工处理的问题。而智能设备的关键内容刚好满足解决失物招领这一问题的基础，它主要包括两方面的关键内容:　自我检测是智能设备的基础 ;自我诊断是智能设备的核心[^1] 。正好利用智能设备的自我检测以及自我诊断完成失物招领过程中的三个关键环节失物接收、失物招领和失物认领。

在上述背景下，本文提出了智能失物招领系统，一方面将致力于改进人与失物之间的关系，通过人与智能设备迅速实先失物在互联网平台的及时公开，从而让失主能够及时认领失物。另一方面迎合现代学生习惯于利用网络处理事情的习惯，充分解决在人口密度大、人群活动频繁的环境下人们小件生活物品遗失的找回问题。同时又可以提供一个新型的新媒体运营平台。

## 1.2 失物招领服务的现状

人们一直在失物招领上投入了巨大的精力，尽量避免资源的浪费。很多国家和地区都设置有专门的失物招领处，用来解决失物招领问题。但是失物招领处并不能及时发布失物信息，人们也不能及时知道自己丢失物品的实时信息。即使要解决也要在人力和财力做出巨大的投入，但收效未必会如人意，而且未必安全可靠。随着智能设备的广泛应用，我们应该通过科学技术，利用智能设备改变人们处理失物原始的低效方案。目前比较主流的解决失物招领方案有以下几种：

- 失物招领处
- 基于 WEB 的网络失物招领信息管理平台
- 智能追踪设备

### 1.2.1 人工失物招领处

人工失物招领处目前多数是公益机构，人们将失物投递在失物箱，然后失物招领处将失物箱的失物统一收到指定的地点，失主们抱着试试看的态度去失物招领处看看自己的失物是不是有幸被投递在失物箱。这种方案比较低效，而且不能保证失主访问失物招领处的有效性问题。由于失物招领箱的设计过于简单，对于失物的安全性、保密性也得不到保障。随着失物频发，它既不能有效解决资源浪费问题；也不能解决失物、失物招领处以及失主之间的时空上的固有矛盾。

### 1.2.2 基于 WEB 的网络失物招领信息管理平台

基于 WEB 的网络失物招领信息管理平台虽然较好的解决了失物招领过程中的信息孤岛的缺陷，一定程度上提高了失物招领的工作效率。但是失物的处理流程依然繁琐，需要相关工作人员接受失物并登记到互联网端的失物招领信息管理平台。而且这种处理流程并不能解决失物招领中存在的保密性、安全性问题；由于失物在处理环节中精力了太多的人工操作，所以其的保密性和安全性都会大打折扣。总之基于 WEB 的网络失物招领信息管理平台虽然一定程度上解决了失物招领中存在的部分问题，但始终操作流程繁琐，没能从根本上解决失物招领的诸多问题。但通过本文介绍的智能失物招领系统将最大程度上解决失物招领中的诸多矛盾。该系统将失物接收、失物招领和失物认领完全分离开来，并智能化。这样最终才决解决了失物、失物招领处以及失主之间的固有矛盾 - 时空上的差异性；并同时保障了失物招领过程中信息的保密性、安全性。

### 1.2.3 智能追踪设备

目前国际上最新的关于解决失物问题的非智能追踪设备莫属，2014 年美国新创科技公司 Tile 发明的智能追踪设备 Tile（如图 1.1 和 1.2 所示）也许未来会成为失物招领的中坚力量，但目前来看并没有取得广大的市场。

![Tile Mate](./assets/images/001.jpg)

图 1.1 智能追踪设备 Tile Mate

![Tile Slim](./assets/images/002.jpg)

图 1.2 智能追踪设备 Tile Slim

从外观看上去，Tile 是一个设计简洁的白色小方块，有一个圆孔，可以方便的穿在希望跟踪的物品上。它的功能十分强大，能追踪你任何丢失的东西。从而找回你的失物。它甚至可以组建一个失物招领的社交网络。诚然这个思路完全和失物招领处不同，但这只是在失物上做文章，并没有真正解决失主与失物的矛盾。试想一下，如果你的钱包落在了火车上，即使你能通过智能追踪设备追踪到你的钱包，但又有什么用呢！追踪到了也毫无意义，任然需要解决失物与失主的矛盾 - 它们在时空上的差异性。

目前主流的解决方案都不能很好解决失主与失物的固有矛盾，人们必须寻找一种新的解决方案。

## 1.3 论文内容与章节安排

本论文针对失物招领服务和人们的实际需求设计出了一套智能的失物招领系统。本论文一共分为五章内容，详细章节内容安排如下：

第一章 绪论：简要介绍课题的研究背景和意义，失物招领的发展现状以及论文的章节安排。

第二章 系统总体设计及功能模块简介：介绍本系统的技术选型、架构设计、总体框架设计、流程设计以及主要功能模块。

第三章 智能失物招领箱机械结构设计与控制：介绍了绍智能失物招领箱的机械结构设计及其控制的实现。

第四章 系统其他模块功能的设计与实现：介绍了整个数据基础平台的架构、数据库设计和核心功能模块的实现、以及失物招领管理平台和失物认领平台的功能及其实现；并对其重要功能模块进行实测，证明本系统的稳定性。

第五章 总结与展望：对本文的研究工作和开发设计成果进行总结，并对系统的进一步优化和发展提出展望。

# 第二章 2 系统总体设计及功能模块简介

## 2.1 系统功能、目标以及特点

在本系统中拾到失物的用户将利用基于 Raspberry Pi 3B 构建智能失物箱完成失物的投递，然后由其采集失物信息（图片为主），并将信息由通信模块经 HTTP 协议同步存储到系统的基础数据平台；随后失物招领管理平台将从数据基础平台获取失物信息（website 呈现），而管理平台管理员在平台上录入失物验证信息（例如：比如某个用户投递了一张饭卡，根据采集到的图片信息，管理员可以设置如下验证信息：１、谁的饭卡？２、该学生的学号多少？）随后验证信息同步存储到系统统基础数据平台供智能失物招领箱验证失物与用户的关系，在通过其自身的通信模块控制失物箱的打开与关闭。而用户根据验证结果将会匹配相应的失物。当然这里匹配的准确性取决于智能失物招领箱的信息采集模块以及管理平台最终同步到数据基础平台的验证信息。更重要的是管理平台的管理员能通过智能失物招领箱的反馈信息调整它的信息采集模块的准确性和验证信息的精确性。整个平台形成了一个反馈系统，这对系统性能以及服务的稳定性、准确性有了极大地提升。

本系统通过利用 Raspberry Pi 3B 和 B/S 架构模式[^17][^18]构建了一个可反馈的闭环智能失物招领系统，很大程度上能够解决传统失物招领存在的一系列问题。

## 2.2 系统技术选型

在进行了大量的调研和分析后，本系系统将基于如下的技术方案实现：

### 2.2.1 智能失物招领箱的技术选型

#### 2.2.1.1 Raspberry Pi 3B

树莓派是尺寸仅有信用卡大小的一个小型电脑，可以将树莓派连接电视、显示器、键盘鼠标等设备使用。树莓派能替代日常桌面计算机的多种用途，包括文字处理、电子表格、媒体中心甚至是游戏。并且树莓派还可以播放高至 1080p 的高清视频，同时树莓派也能满足网络通信的各种需求。树莓派以其低能耗、移动便携性、GPIO 等特性，很多在普通电脑上难以做好的事情，用树莓派却是很适合的。本系统采用配置摄像头和触控屏幕的树莓派实现对失物的信息采集并控制失物箱机械结构的动作。完成失物招领系统最核心的步骤。当然在考虑树莓派之前也考虑了 STM32F407 开发板，不过一方面由于 STM32F407 的摄像头模块像素比较低，采集到的信息无法识别；另一方面传统单片机在通信方面实现较为复杂，而且其尺寸较大，不适合本系统。

#### 2.2.1.2 步进电机

本系统致力于解决小型贵重物品失物招领的自动完成，而且安放位置类似于摄像头的安放，会在不同的地点安放，最终形成一个网络系统。故为了减小招领箱的实际尺寸，其机械结构（关于失物招领箱的机械结构后面会有详细的介绍）将采取圆柱形结构，同事每一个失物招领箱将会有８个失物储藏柜。为了能够使失物储藏柜自动的接收失物，本系统将用树莓派控制步进电机，最终将失物分配到合适的失物储藏柜等待失主前来认领。

### 2.2.2 基础数据平台以及管理平台的技术选型

#### 2.2.2.1 MongoDB

MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。它是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。他支持的数据结构非常松散，是类似 json 的 bson 格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。为了满足系统基础数据平台的需求，本系统将采用 MongoDB 存储平台的数据。

#### 2.2.2.2 Node.js 和 Python

在系统开发语言上选择 Node.js 和 Python；Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。非常适合本系统的开发。而 Python 是一种面向对象的解释型计算机程序设计语言，在利用树莓派控制摄像头拍照和步进电机是十分高效和方便。

#### 2.2.2.3 React 和 webpack

React 是一个用于构建用户界面的 JavaScript 库。它主要用于构建 UI，一般认为 React 是 MVC 中的 V（视图）。因其拥有较高的性能，代码逻辑非常简单，所以在构建本系统的管理平台时将利用 React 来实现试图层。而 webpack 作为现代前端工程化的资源加载/打包利器，它将根据模块的依赖关系进行静态分析，然后将这些模块按照指定的规则生成对应的静态资源。从而方便管理我们的项目源码。

#### 2.2.2.4 fetch

fetch 是异步请求的一种解决方案，比传统的 AJAX（AsynchronousJavaScriptandXML） 更优雅，使用 fetch 解决了 AJAX 的回调地狱问题。fetch 可以使用了客户端脚本与　Web　服务器交换数据，Web 页面不用打断用户的交互流程进行整页重新加裁，可以动态地、局部的对页面进行更新，提高了用户体验，使开发操作和外观类似桌面软件的 Web 应用软件成为可能[^14]。

## 2.3 系统架构设计

### 2.3.1 系统网络架构

本论文开发的基于树莓派的智能失物招领系统旨在解决失物招领存在的诸多问题，并以智能终端的形式向人们提供服务。其系统网路架构图如图 2.1 所示。

![系统网络架构](./assets/images/007.png)

图 2.1 系统网络架构 

如图 2.1 所示，Mobile 端主要是通过网络实时获取失物信息，甚至可以实现服务器端的数据推送，当有失物进入系统之后，服务器端立即将信息推送到 Mobile 端；从而杜绝失物信息孤岛；同时 Mobile 端及时匹配失物与失物箱的位置，失主能根据自己时间，自主的选择认领失物。智能终端用来使用户投递失物、接收失物并认领失物。PC 端主要是失物招领管理平台，录入失物认领的验证信息。而整个服务器作为系统的基础服务，必须保证它可靠、稳定的运行。

### 2.3.2 B/S 架构模式

本论文根据系统功能需要和业务逻辑选择 B/S 架构模式（浏览器/服务端模式），来实现智能失物招领系统的多方面需求。系统架构图如图 2.2 所示：

![B/S 架构模式](./assets/images/008.jpg)

图 2.2 B/S 架构模式

无论是智能终端、手机、PC，还是其他表示层都能通过应用层的 web 服务器来访问本系统提供的服务，而数据库服务则独立开来，以保障其提供稳定的服务。

### 2.3.3 B 端中的 MVC

失物招领管理平台和失物认领平台都是典型的 B 端应用，它们采用了经典的 MVC 框架设计模式，体现了动态程序设计。MVC 框架将应用程序分成了三个模块，即模型（Model）、视图（View）、控制器（Controller）。利用控制器实现模型和视图的同步，同时降低 Model 层和 View 层的耦合度，提高了控制程序的可维护性和拓展性[^15]。MVC 模式的组成部分和系统架构的三个层次的关系如图 2.3 和 2.4 所示：

![MVC 的依赖关系](./assets/images/009.png)

图 2.3 MVC 的依赖关系

![MVC 的调用关系](./assets/images/010.png)

图 2.4 MVC 的调用关系

MVC 的 View 层是根据业务逻辑和请求内容在界面上的展示，是用户开到并与交互的界面，因而视图层在 B/S 架构中对应于浏览器端展示的网站内容。Controller 层作用是调用模型层和视图层去完成用户的相应操作请求。Model（模型）在应用程序中用户处理数据逻辑，一般业务功能都由模型层来完成，一个模型能为多个视图提供数据，因而对一般应于 B/S 架构中的业务层和数据层，当然如果业务非常复杂在系统中也可以加入 Service 层，专门用 Service 层处理复杂的逻辑；不过本系统业务逻辑比较简单，暂时不用引入 Service 层。。MVC 模式使得应用程序各个层级之间的耦合性大大降低,从而对应用程序的升级与更新,业务功能的扩展和维护,开发效率的提升具有积极的作用[^13]。

## 2.4 系统设计总体框架

本系统采用阿里云服务器作为后端服务器，使用 MongoDB 来存储数据服务，并接入支付宝用户认证模块来保证失物领取的可靠性、安全性。总之 智能失物招领系统是依托于多种技术结合的产物，其系统的结构大致如图 2.5 所示。

在图　2.5 的总体设计中，大致流程如下：当捡到失物的用户在失物认领领系统发出投递失物信号后，经失物认领领系统的通信模块与智能失物招领箱的通信模块通信后，授权智能失物招领箱的失物箱控制模块打开失物箱的闲置储物柜；在用户投递失物并关闭失物箱储物柜后，触发智能失物箱信息采集模块采集失物信息（目前以照片为主），采集后的失物信息再由通信模块经由　HTTP Server 同步存储到失物招领基础数据平台。随后失物招领管理平台从失物招领系统基础数据平台获取失物信息（website 呈现），失物招领管理平台管理员在平台上录入失物验证信息（例如：比如某个用户投递了一张饭卡，根据采集到的图片信息，管理员可以设置如下验证信息：１、谁的饭卡？２、该学生的学号多少？）随后验证信息同步存储到失物招领基础数据平台供失物认领系统验证失物与用户的关系，在通过其身的通信模块与智能失物招领箱的通信模块通信，从而自助的控制失物箱的打开与关闭。而用户根据验证结果将会匹配相应的失物。当然这里匹配的准确性取决于智能失物招领箱的信息采集模块以及失物招领管理平台最终同步到智能招领系统基础数据平台的验证信息。更重要的是失物招领管理平台的管理员能通过失物认领系统的反馈信息调整智能失物招领箱的信息采集模块的准确性和验证信息的精确性。整个平台形成了一个反馈系统，这对系统性能以及服务的稳定性、准确性有了极大地提升。

![智能失物招领系统架构图](./assets/images/011.png)

图 2.5 智能失物招领系统架构图

整个系统大致分为：智能失物招领箱、失物招领基础数据平台、失物招领管理平台和失物认领平台四个模块，稍后会一一介绍。

## 2.5 系统功能模块简介

### 2.5.1 智能失物招领箱与失物认领平台

智能失物招领箱与失物认领平台流程设计如图 2.6 所示，用户使用操作流程具体如下：

1 用户在智能失物招领箱触摸屏界面选择认领失物还是投递失物。

2 如果用户选择我要投递，则失物招领箱在树莓派的 GPIO 口控制的步进电机的带动下打开可用的储物柜，用户投递完失物后手动关闭储物柜，失物投递成功。如果用户选择我要认领，则跳转到支付宝第三方登录平台，先认证用户基本信息，若用户取消授权则服务终止（认领失物时，首先要保证用户的真实性，甚至可靠性；可以考录接入芝麻信用分来作为初步评判标准）；若用户通过授权则跳转到失物列表页面

3 当用户浏览失物列表页时，发现疑似自己丢失的物品时，可进入失物详情页面进行相关问题验证

4 用户通过失物验证问题后，再树莓派控制打开储物柜，用户领走失物；若用户未通过失物验证问题则服务终止

![智能失物招领箱与失物认领平台流程设计图](./assets/images/012.png)

图 2.6 智能失物招领箱与失物认领平台流程设计图

### 2.5.2 失物招领基础数据平台

失物招领基础数据平台是基于 MongoDB 的数据库集群，在智能失物招领箱与失物认领平台流程设计图处理流程最后阶段，失物投递成功后，树莓派会通过摄像头模块采集失物信息，然后通过 HTTP 协议将图片数据信息发送到 web Server，并在失物招领基础数据平台做好数据记录。

### 2.5.3 失物招领管理平台

失物招领管理平台流程设计如图 2.7 所示，用户使用操作流程具体如下：

1 用户通过支付宝第三方用户认证方式登录管理平台，如果用户同意授权并且有管理员权限进入失物招领管理平台提供的服务模块。

2 目前平台提供失物、用户以及失物箱三个模块的功能，用户根据需求选择所需的服务

3 根据用户使用服务对象的不同将用户产生的数据同步到失物招领基础数据平台

![失物招领管理平台流程设计图](./assets/images/013.png)

图 2.7 失物招领管理平台流程设计图

# 第三章 3 智能失物招领箱机械结构设计与控制

智能失物招领箱主要包含失物箱子模块、储物柜控制子模块、信息采集子模块和通信子模块这四个模块，整个智能失物招领箱的功能有着四个子模块配合实现；缺一不可。失物箱子模块主要是智能失物招领系统的机械结构支撑，分为八个储物柜。每个储物柜用来放置用户投递的失物；同时每一个储物柜的打开都通过树莓派的 GPIO 控制。信息采集子模块则由树莓派的摄像头模块控制，当用户手动关闭储物柜时，树莓派的 GPIO 口会接受到信后，随后调用树莓派的摄像头模块对用户投递的失物采集信息，信息采集完毕后由通信子模块将采集到的信息发送到 HTTP Server 然后同步存储到失物招领基础数据平台，为失物招领管理平台、失物认领平台提供数据支持。

## 3.1 失物招领箱设计简图

智能失物招领箱整体是一个圆柱形的结构，内置一个可以转动的证正六棱柱；储物柜分被放置于正六棱柱内。失物招领箱机械结构简图如图 3.1 所示

图　3.1 失物箱设计简图

## 3.2 树莓派 GPIO 硬件控制与编程简介

树莓派除了提供常见的网口和USB接口 ，还提供了一组 GPIO（General Purpose Input/Output）接口。这组 GPIO 接口大大拓展了树莓派的能力。GPIO 不仅能实现通信，还能直接控制电子元器件，从而让用户体验到硬件编程的乐趣。

树莓派功能模块图 3.2 所示，在本系统中主要将用到树莓派摄像头接口、板载蓝牙和 WIFI 和 GPIO 引脚模块。

![树莓派功能模块图](./assets/images/014.png)

图 3.2 莓派功能模块图

40 个 GPIO 引脚详解如图 3.3 所示，在树莓派 3 上，GPIO 接口由 40 个针脚（PIN）组成。每个针脚都可以用导线和外部设备相连。你可以通过焊接的方式来把导线固定在 PIN 上，也可以用母型的跳线套接在 PIN 上。40 个 PIN 中，有固定输出的 5V（2、4 号 PIN）、3.3V（1、17号 PIN）和地线（Ground，6、9、14、20、25、30、34、39）。如果一个电路两端接在，5V 和地线之间，该电路就会获得 5V 的电压输入。27 和 28 号 PIN 标着 ID_SD 和 ID_SC。它们是两个特殊的　PIN。它们属于 ID EEPROM (Electrically Erasable Programmable Read-Only Memory) 接口，用于和拓展树莓派功能的附加电路板通信。其他的 PIN 大多编程 GPIOX 的编号，如 GPIO14。树莓派的操作系统中，会用 GPIO 的编号 14 来指代这个 PIN，而不是位置编号的 8。有一些 PIN 除了 GPIO 功能外，还提供了高级端口功能。比如说 GPIO14 和 GPIO15 就同时可以充当 UART 端口。此外，GPIO 上还能找到 I2C 和 SPI 端口。

在计算机中，通常用高、低两个电压来表示二进制的 1 和 0。树莓派也是如此。GPIO 用相同的方式来表示数据。每个 GPIO 的 PIN 都能处于输入或输出状态。当处于输出状态时，系统可以把 1 或 0 传给该 PIN。如果是 1，那么对应的物理 PIN 向外输出 3.3V 的高电压，否则输出 0V 的低电压。相应的，处于输入状态的 PIN 可以探测物理 PIN 上的电压。如果是高电压，那么该 PIN 将向系统返回 1，否则返回 0。就是利用上述简单机制，GPIO 实现了和物理电路的互动。正式由于这样才能实现树莓派控制步进电机，稍后会展开介绍。

![树莓派　40 个　GPIO 引脚详解图](./assets/images/015.png)

图 3.3 40 个 GPIO 引脚详解

## 3.3 步进电动机工作原理简介

步进电动机的运转状态与普通电动机不同，它随供给电源的脉冲一步一步的转动，是一种数字电动机。步进电动机能随供给的电源脉冲数转动相应步数，而每一步的角度是固定的，所以步进电动机能按控制转动所需的圈数、角度，广泛应用在数控机床、自动化设备、仪器仪表等行业。本节介绍本系统采用的的反应式步进电动机的基本工作原理。

反应式步进电动机是根据磁阻性质产生转矩工作的，遵循磁通总是沿磁阻最小的路径闭合的原理，由磁拉力形成转矩。下面介绍的步进电动机模型每步为 3 度。    

步进电动机的定子铁心，在内周有六个磁极，每个磁极上有 5 个小齿，齿中心距为 9 度，齿宽与齿间隔大小一样，径向的两个磁极组成一对磁极，定子铁心由冲制的硅钢片叠制而成。步进电动机的转子铁心，转子上没有线圈，但在外圆周有 40 个小齿，齿中心距为 9 度，齿宽与齿间隔大小一样，转子铁心也由冲制的硅钢片叠制而成。由于定子磁极上的小齿的齿宽与齿间隔与转子上的小齿一样，所以当定子的一对磁极小齿与转子小齿对齐时，另两对磁极小齿与转子小齿角度相差 3 度或 -3 度，见图 3.4 和 3.5。

![步进电动机的定子铁心和转子铁心](./assets/images/033.jpg)

图 3.4 步进电动机的定子铁心和转子铁心

![定子与转子装配图](./assets/images/034.jpg)

图 3.5 定子与转子装配图

反应式步进电机多为三相线圈，本模型的三对磁极可绕三组线圈组成三相绕组。由脉冲信号发生器按照给定的设置不断向步进电机驱动器发送控制脉冲信号，驱动器又根据转动方向与运转状态向三相线圈供电（每输入一个脉冲信号切换一次供电状态），每一个控制脉冲电信号转子转动一步，每步转的角度称为步距角。 三相线圈分为 A、B、C 三个线圈，图 3.6 是用三个开关晶体管向三个线圈供电的连接图：三个线圈的一端与电源正极相连，另一端分别与驱动器内三个开关晶体管连接，构成星形连接。每个时期仅有一个开关晶体管导通一个线圈通电，这是一种基本的也是常用的工作方式。 

![三相星形开关电路原理图](./assets/images/035.jpg)

图 3.6 三相星形开关电路原理图

为了清楚的演示该步进电机模型的工作状态，我们取模型的正视图，图 3.7 是模型的正视图，清楚的显示了三相线圈的组合与连接，黄色线圈是 A 相线圈、绿色线圈是 B 相线圈、红色线圈是 C 相线圈。 

![步进电机模型的正视图](./assets/images/036.jpg)

当 BG1 导通 A 相线圈通电，此时转子被磁力吸引静止不动。第一个控制脉冲来时，BG1 截止 BG2 导通，B 相线圈通电，磁通按最近的路径闭合，在磁力拉动下，转子开始向逆时针方向转动一个步距角，这里就是 3 度。 如果此后不来控制脉冲，转子将停止在这个角度不动。如果再来一个控制脉冲，开关晶体管 BG2 截止 BG3 导通，C 线圈通电，转子在磁拉力作用下开始继续转动。以此类推步进电机就这样在脉冲的控制下转动。

## 3.4 智能失物招领箱控制的设计与实现

智能失物箱的主要功能是当用户认领失物时让用户可以从合适的储物柜里取出失物，用户投递失物时让用可以将失物投递到合适的储物柜里。那么当用户要投递，系统必须控制相应的储物柜运动到合适的位置，打开储物柜柜门，让用户投递失物；用户投递失物后，手动关闭储物柜柜门后，系统必须及时采集失物信息，然后将采集的信息发送到基础数据平台。用户认领失物时，系统必须控制相应的储物柜运动到合适的位置然后打开柜门，让用户取出失物。这一系列的控制动作都需要树莓派的控制，当然也需要步进电机、电磁铁、弹簧按钮的协助才能完成，下面将详细的介绍。

### 3.4.1 储物柜的旋转和柜门开关的控制与实现

当失物招领管理平台收到投递失物请求后，首先查询数据库失物箱中的可用储物柜中编号最小的储物柜（由于每次投递都必须转动储物柜找到空柜子，那么我们必须保证每次投递失物取可用储物柜的算法一致，才能保证正常的秩序；当然这里用的是最暴力最简单的算法，会导致某些储物柜一致得不到使用）和最后一次使用的储物柜，然后计算出步进电机需要转动的角度。再根据步进电机的步矩角算出脉冲数，最后通过 GPIO 控制步进电机转过相应的角度。核心代码如下：

```javascript
const Gpio = require('onoff').Gpio
const pulse_mumber = 60
const switching_transister_a_pin = new Gpio(17, 'out')
const switching_transister_b_pin = new Gpio(23, 'out')
const switching_transister_c_pin = new Gpio(24, 'out')

process.on('SIGINT', function () {
  switching_transister_a_pin.unexport()
  switching_transister_b_pin.unexport()
  switching_transister_c_pin.unexport()
})

function set_step(v1, v2, v3) {
  switching_transister_a_pin.writeSync(v1)
  switching_transister_b_pin.writeSync(v2)
  switching_transister_c_pin.writeSync(v3)
}

function step() {
  set_step(1,0,0)
  set_step(0,1,0)
  set_step(0,0,1)
  set_step(1,0,0)
}

function forward(pulse_mumber) {
  for(let i = 0; i　< pulse_mumber; i += 1){
    step()
  }
}

forward(pulse_mumber)
``` 

认领过程和投递过程类似这里就不在赘述。

### 3.4.2 信息采集与通信的控制与实现

当用户投递玩失物后，手动关闭储物柜柜门后，首先按下了弹簧按钮，GPIO 被监听的引脚获得高电平的输入，GPIO 立即使电磁铁得电，储物柜柜门关闭。延迟时间到后 GPIO 控制树莓派的摄像头模块对失物进行拍照，信息采集完毕后将其发送到基础数据平台的接口，完成信息采集功能。核心代买如下：

```javascript
const Gpio = require('onoff').Gpio
const RaspiCam = require("raspicam")
const spring_button = new Gpio(18, 'in')
const electromagnet = new Gpio(4, 'out')
const delay = 1000

process.on('SIGINT', function () {
  spring_button.unexport()
  electromagnet.unexport()
})

spring_button.watch(function(err, value) {
  if　(err) {
    throw err
  }

  setTimeout(goCamera, delay)
})

function goCamera() {
  const raspicamOptions = {
    mode: 'photo',
    output: ''
  }
  const camera = new Raspberry(raspicamOptions)

  camera.start()
  camera.stop()

  carame.on('stop', function(err, timestamp, filename) {
    if　(err) {
      throw err
    }

    save_lost_property_information(timestamp, filename)
  })
}

```

# 第四章　4 系统其他模块功能的设计与实现

## 4.1 系统基础数据平台设计与实现

### 4.1.1 数据库的设计

作为智能失物招领服务系统,系统数据库占有非常重要的地位,它用来存储用户投递失物后产生的一系列数据,随着失物的不断增多数据量也会越来越庞大。本系统需要设计多张数据表,为此采用介于关系型数据库和非关系型的数据库（MongoDB） 进行数据的存储,使得数据存储更方便更高效。本系统主要有数据库表有失物表 goods、失物分类表 goodsCategory、用户表 user、失物箱表 lostBox。下面以系统流程为蓝图，从用户投递失物到用户认领失物来说明系统功能模块设计过程中数据库之间的关系。

#### 4.1.1.1 数据库表的基本结构

失物表包括 _id (失物ID), title　(失物名称)、description (失物描述)、lost_box_id (智能失物箱　id)、sark_code (失物箱储物柜编号)等字段，失物表的逻辑结构如下表所示：

|字段名|数据类型|默认值|说明|主键|
|:-----|:-----|:-----|:-----|:-----|
|_id|ObjectId|ObjectId|失物ID|是|
|title|String|''|失物名称|否|
|description|String|''|失物描述|否|
|lost_box_id|ObjectId|ObjectId|智能失物箱　ID|否（外键）|
|sark_code|Number|1|失物箱储物柜编号（每次投递失物时找编号最小的未被占用的箱子）|否|
|category_id|ObjectId|ObjectId|失物分类 ID|否（外键）|
|images|Object|{}|采集的失物图片|否|
|valid_questions|Array|[]|领取失物的验证问题|否|
|claimed_users|Array|[]|领取过失物的用户机及领取状态|否|
|status|Number|1|失物状态|否|
|created_at|Date|Date.now|用户投递失物时间|否|
|updated_at|Date|Date.now|失物信息最后更新时间|否|

关于几个引用类型的说明:

- images

```javascript
{
  origin: ['src1', 'src2'],
  graffiti: ['src1', 'src2']
}
```

- valid_questions

```javascript
{
  name: String,
  options: [
    { value: 'A', title: String },
    { value: 'B', title: String },
    { value: 'C', title: String },
    { value: 'D', title: String }
  ],
  answer: { value: 'B', title: String }
}
```

- claimed_users

```javascript
{
  status: 0|2|3|4,
  user_id: Schema.Types.ObjectId
}
```
- statuc
	- 0 成功领取
	- 1 等待领取
	- 2 领取失败，验证信息错误
	- 3 领取失败，支付宝认证失败
	- 4 领取失败，意外错误

为了用户更好的找到自己的失物，系统引入了失物分类表来整理分类，它包括 name (分类名称)、status (分类状态)等字段，失物分类表的逻辑结构如下表所示：

|字段名|数据类型|默认值|说明|主键|
|:-----|:-----|:-----|:-----|:-----|
|_id|ObjectId|ObjectId|失物ID|是|
|name|String|''|失物名称|否|
|status|Number|1|失物状态|否|
|created_at|Date|Date.now|用户投递失物时间|否|
|updated_at|Date|Date.now|失物信息最后更新时间|否|

为了确定用户身份，使得失物认领的安全性得到保障，本系统采用支付宝用户第三方认证机制，系统用户表包括　user_id (用户ID)、nick_name (用户昵称)、is_ilafb_admin (是否是本系统管理员)等字段，用户表的逻辑结构如下表所示：

|字段名|数据类型|默认值|说明|主键|
|:-----|:-----|:-----|:-----|:-----|
|avatar|String|null|用户头像地址|否|
|nick_name|String|null|用户昵称	|否|
|city|String|null|市名称|否|
|province|String|null|省份名称|否|
|gender|String|null|性别（F：女性；M：男性）|否|
|user_type_value|String|null|用户类型|否|
|is_licence_auth|String|null|用户头像|否|
|is_certified|String|null|用户头像|否|
|is_certify_grade_a|String|null|用户头像|否|
|is_student_certified|String|null|是否是学生|否|
|is_bank_auth|String|null|用户头像|否|
|is_mobile_auth|String|null|用户头像|否|
|alipay_user_id|String|null|用户头像|否|
|user_id|String|null|支付宝用户的userId|是|
|user_status|String|null|用户状态（Q/T/B/W）|否|
|is_id_auth|String|null|用户头像|否|
|is_ilafb_admin|Boolean|false|是否为管理员|否|
|created_at|Date|Date.now|用户投递失物时间|否|
|updated_at|Date|Date.now|失物信息最后更新时间|否|

几个枚举类型字段的说明：

- user_type_value
	- 1 代表公司账户
	- 2 代表个人账户

- user_status
	- Q 代表快速注册用户 
	- T 代表已认证用户 
	- B 代表被冻结账户 
	- W 代表已注册，未激活的账户

失物箱表主要包括　_id (失物箱ID)、name (失物箱名称)等字段，失物箱表的逻辑结构如下表所示：

|字段名|数据类型|默认值|说明|主键|
|:-----|:-----|:-----|:-----|:-----|
|id|ObjectId|ObjectId|失物箱ID|是|
|name|String|''|失物箱名称|否|
|location|String|''|失物箱地址|否|
|sarks|Object|{}|失物箱储物柜状态|否|
|lasted_sark|Object|{code: 1, used: false}|最后一次被采集的失物箱储物柜|否|
|status|Number|false|失物箱状态|否|
|created_at|Date|Date.now|用户投递失物时间|否|
|updated_at|Date|Date.now|失物信息最后更新时间|否|

几个主要字段的说明：


- sarks

```javascript
{
	'1': {
		code: 1,
		used: false
	}
}
```

- status
	- -1 废弃
	- 0 报修
	- 1 正常
	- 2 无空余柜子

### 4.1.2 基础数据平台架构模式

为了保障基础数据平台的稳定运行，本系统采取数据库集群的方案；多台主机一起工作，各自运行一个或几个服务，各为服务定义一个或多个备用主机，当某个主机故障时，运行在其上的服务就可以被其它主机接管。架构图如图　4.1 所示：

![MongoDB Relica Set 副本集方式](./assets/images/017.png)

图 4.1 MongoDB Relica Set 副本集方式

### 4.1.3 系统基础数据平台的实现

为了保证本系统稳定高效的运行，我们采取集群工作方式（多服务器互备方式 - MongoDB Relica Set 副本集方式实现本系统基础数据平台的集群部署方式。

- 硬件设备

MongoDB Relica Set 副本集方式的急群中副本集机器数量为至少3个，本系统也按照这个数量进行部署。准备两台机器 `192.168.1.136`、`192.168.1.137`、`192.168.1.138`。 `192.168.1.136` 当作副本集主节点，`192.168.1.137`、`192.168.1.138`作为副本集副本节点。

- 分别安装　MongoDB

```bash
#存放整个mongodb文件
mkdir -p /data/mongodbtest/replset
 
#存放mongodb数据文件
mkdir -p /data/mongodbtest/replset/data
 
#进入mongodb文件夹
cd  /data/mongodbtest

#下载mongodb的安装程序包
wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.4.8.tgz

#解压下载的压缩包 
tar xvzf mongodb-linux-x86_64-2.4.8.tgz

#分别在每台机器上启动mongodb
/data/mongodbtest/mongodb-linux-x86_64-2.4.8/bin/mongod  --dbpath /data/mongodbtest/replset/data   --replSet repset

# log
Sun Dec 29 20:12:02.953 [rsStart] replSet can't get local.system.replset config from self or any seed (EMPTYCONFIG)
Sun Dec 29 20:12:02.953 [rsStart] replSet info you may need to run  replSetInitiate -- rs.initiate() in the shell -- if that is not already done
```

- 初始化副本集

```bash
#在三台机器上任意一台机器登陆mongodb
/data/mongodbtest/mongodb-linux-x86_64-2.4.8/bin/mongo
 
#使用admin数据库
use admin

##定义副本集配置变量，这里的 _id:”repset” 和上面命令参数“ –replSet repset” 要保持一样
config = { 
	_id:"repset", 
	members: [
		{_id:0, host: "192.168.1.136:27017"},
		{_id:1, host: "192.168.1.137:27017"},
		{_id:2, host: "192.168.1.138:27017"}
	]
}

# log
{
  "_id" : "repset",
  "members" : [
    {
      "_id" : 0,
      "host" : "192.168.1.136:27017"
    },
    {
      "_id" : 1,
      "host" : "192.168.1.137:27017"
    },
    {
      "_id" : 2,
      "host" : "192.168.1.138:27017"
    }
  ]
}

#初始化副本集配置
rs.initiate(config);

# log
{
  "info" : "Config now saved locally.  Should come online in about a minute.",
  "ok" : 1
}

#查看集群节点的状态
rs.status();

# log
{
  "set" : "repset",
  "date" : ISODate("2013-12-29T12:54:25Z"),
  "myState" : 1,
  "members" : [
     {
        "_id" : 0,
        "name" : "192.168.1.136:27017",
        "health" : 1,
        "state" : 2,
        "stateStr" : "SECONDARY",
        "uptime" : 1682,
        "optime" : Timestamp(1388319973, 1),
        "optimeDate" : ISODate("2013-12-29T12:26:13Z"),
        "lastHeartbeat" : ISODate("2013-12-29T12:54:25Z"),
        "lastHeartbeatRecv" : ISODate("2013-12-29T12:54:24Z"),
        "pingMs" : 1,
        "syncingTo" : "192.168.1.138:27017"
     },
     {
        "_id" : 1,
        "name" : "192.168.1.137:27017",
        "health" : 1,
        "state" : 2,
        "stateStr" : "SECONDARY",
        "uptime" : 1682,
        "optime" : Timestamp(1388319973, 1),
        "optimeDate" : ISODate("2013-12-29T12:26:13Z"),
        "lastHeartbeat" : ISODate("2013-12-29T12:54:25Z"),
        "lastHeartbeatRecv" : ISODate("2013-12-29T12:54:24Z"),
        "pingMs" : 1,
        "syncingTo" : "192.168.1.138:27017"
     },
     {
        "_id" : 2,
        "name" : "192.168.1.138:27017",
        "health" : 1,
        "state" : 1,
        "stateStr" : "PRIMARY",
        "uptime" : 2543,
        "optime" : Timestamp(1388319973, 1),
        "optimeDate" : ISODate("2013-12-29T12:26:13Z"),
        "self" : true
     }
  ],
  "ok" : 1
}
```

至此高可用　MongoDB　集群已经搭建完毕。 

## 4.2 失物认领平台与失物招领管理平台核心功能的设计与实现

### 4.2.1 失物投递模块的设计与实现

失物投递模块是失物认领平台核心功能模块之一，具体设计流程如图 4.2 所示：

![失物投递模块流程图](./assets/images/024.png)

图 4.2 失物投递模块流程图

用户进入应用首页（如图 4.3 所示），点击我要投递按钮后，经 HTTP Request 失物认领平台通过控制树莓派 GPIO 串口驱动步进电机旋转到空的储物柜并打开储物柜柜门，等待用户投递失物；当用户投递失物并关闭储物柜柜门后，由于失物认领平台监听了储物柜柜门关闭时触碰的 GPIO 输入口，所以此时会通过控制树莓派的摄像头模块采集失物信息，采集完失物信息后失物认领平台会将信息同步到失物认领基础数据平台，以供失物管理平台使用。至此失物投递完成。

![失物认领平台首页](./assets/images/025.png)

图 4.3 失物认领平台首页

### 4.2.2 登录模块的设计与实现

登录模块是失物认领平台与失物招领管理平台核心功能的基础，在系统技术实现方案中我们已经选取了网站支付宝登录快速接入方案，具体授权流程如图 4.4 所示：

![OAuth 2.0 授权](./assets/images/018.png)

图 4.4 OAuth 2.0 授权

要在应用中使用支付宝开放产品的接口能力，首先要去去蚂蚁金服开放平台（open.alipay.com），在开发者中心创建登记应用，并提交审核，审核通过后会通过生成的应用唯一标识（APPID），并且申请开通开放产品使用权限，通过APPID让应用调用开放产品的接口。达到用户认证的目的。接口调用的相关流程如图 4.5 所示：

![蚂蚁金服开放平台接口调用流程图](./assets/images/019.png)

图 4.5 蚂蚁金服开放平台接口调用流程图

蚂蚁金服开放平台接口调用核心 SDK（Node.js版）封装如下，具体请才考附近 ILAFB-node 中的相关代码。

```javascript
const crypto = require('crypto')
const moment = require('moment')
const config = require('../config')
const { post } = require('../common/https')

class AlipayAuth {

	constructor() {
		const { app_id, sign_type } = config.alipay
		const { version } = config.apis

		this.auth = {
			app_id: app_id,
			charset: 'utf-8',
			sign_type: sign_type,
			version: version,
			timestamp: moment().format('YYYY-MM-DD HH:mm:ss')
		}
	}

	signReqData (data) {
		const { rsa_private_key, rsa_public_key } = config.alipay
		const sign = crypto.createSign('SHA256')

		const keys = Object.keys(data).sort()
		let query = ''
		let encodeQuery = ''

		keys.forEach((k) => {
			query += `${k}=${data[k]}&`
		})
		query = query.slice(0, -1)
		
		sign.update(query)

		let signString = sign.sign(rsa_private_key, 'base64')

		keys.forEach((k) => {
			encodeQuery += `${k}=${encodeURIComponent(data[k])}&`
		})
		encodeQuery = encodeQuery.slice(0, -1)

		return (encodeQuery + '&sign=' + encodeURIComponent(signString))
	}

	getAccessToken(auth_code) {
		if (!auth_code) {
			throw new Error('缺少必要参数：auth_code')
		}

		const data = Object.assign({}, this.auth, {
			grant_type: 'authorization_code',
			code: auth_code,
			method: 'alipay.system.oauth.token'
		})
		const options = {
      hostname:'openapi.alipay.com',
			port: 443,
			path: '/gateway.do',
			method:  'POST',
			headers: {
				'Content-Type': 'application/x-www-form-urlencoded',
			}
		}

		return post(options, this.signReqData(data))
	}

	getUserInfo(user_id, access_token) {
		if (!user_id || !access_token) {
			throw new Error('缺少必要参数：user_id 或 access_token')
		}
		const data = Object.assign({}, this.auth, {
			grant_type: 'authorization_code',
			method: 'alipay.user.info.share',
			user_id: user_id,
			auth_token: access_token
		})
		const options = {
      hostname:'openapi.alipay.com',
			port: 443,
			path: '/gateway.do',
			method:  'POST',
			headers: {
				'Content-Type': 'application/x-www-form-urlencoded',
			}
		}

		return post(options, this.signReqData(data))
	}
  
}

module.exports = AlipayAuth
```

### 4.2.3 设置失物验证信息模块的设计与实现

设置失物验证信息模块用户是失物招领管理平台的核心功能，该模块功能在整个系统中也占据着重要的地位；设置失物验证信息模块的准确性决定了整个系统是否准确运行。其大致流程如图 4.6 所示：

![失物招领管理平台 - 设置失物验证信息模块流程图](./assets/images/024.png)

图 4.6 设置失物验证信息模块流程图

失物招领管理平台管理员通过验证进入失物招领管理平台后，进入失物列表页面（如图 4.7 所示）；失物列表页面展示给管理员的是智能失物箱采集的失物信息。管理员必须及时处理智能失物箱采集的失物信息，这样失物才能够被认领。当有新的失物出现在失物列表页面时，管理员需要进入失物详情页（如图 4.8、4.9、4.10所示），在失物详情页你主要要干三件事：添加失物认领验证问题、马赛克相关失物图片。这样用户在失物认领平台的认领失物模块才可以通过刚刚添加的验证问题验证失物的归属问题。

![失物招领管理平台 - 失物列表](./assets/images/020.png)

图 4.7 失物列表

![失物招领管理平台 - 失物详情](./assets/images/021.png)

图 4.8 失物详情

![失物招领管理平台 - 失物详情](./assets/images/022.png)

图 4.9 失物详情

![失物招领管理平台 - 失物详情](./assets/images/023.png)

图 4.10 失物详情

### 4.2.4 失物认领模块的设计与实现

失物认领模块是失物认领平台的核心功能之一，用户通过此功能可以完成对失物的认领，具体流程如图 4.11 所示：

![失物认领模块流程图](./assets/images/026.png)

　4.11 失物认领模块流程图

用户在失物认领平台用户首页点击我要认领后进入支付宝第三方用户认证，当通过认证后进入失物列表页（如图　4.12 所示）寻找自己丢失的疑似失物，找到自己丢失的疑似失物后点击其图片进入失物认领页面（如图 4.13、4.14 所示），完成相关验证问题然后确认认领，用户完成认领流程；失物认领平台验证正确后通过控制树莓派的　GPIO 口打开相应的储物柜柜门，接下来用户可以领走失物。

![失物列表页面](./assets/images/027.png)

图　4.12 失物列表页面

![失物认领页面 - 上](./assets/images/028.png)

图　4.13 失物认领页面 - 上

![失物认领页面 - 下](./assets/images/029.png)

图　4.14 失物认领页面 - 下

## 4.3 系统测试

### 4.3.1 测试环境

本系统采用　B/S 架构，基础数据平台使用阿里云　ECS 服务器搭建　MongoDB 集群，实现对数据的管理；智能终端使用树莓派。测试环境如下表所示：

|编号|类型|名称|运行环境|
|:----|:----|:----|:----|
|1|数据库服务器|失物招领基础数据平台|阿里云 ECS|
|2|管理平台|失物招领管理平台|阿里云 ECS|
|3|认领平台|失物认领平台|树莓派/Google Chrome|

### 4.3.2 功能测试

本节对本论文设计的失物招领系统的核心功能在测试环境上进行实测，测试详情如下表所示。

|核心功能编号|功能名称|测试状况|测试结果|
|:----|:-----|:-----|:------|
|1|失物投递|点击我要投递，观察　GPIO 相应串口的输出|与预期相同，通过|
|2|登录|使用用户名密码或扫码登录|与预期相同，通过|
|3|设置失物验证信息|添加失物验证问题和马赛克处理实物图片|与预期相同，通过|
|4|认领|点击我要投递，观察　GPIO 相应串口的输出|与预期相同，通过|

# 第五章 5 总结与展望

## 5.1 工作总结

本论文设计了基于树莓派控制的智能失物招领系统，经过分析后基本能解决传统失物招领过程中的工作效率低下、找回率低、保密性差、管理分散等问题。本系统提高了失物招领的工作效率,减少人们的直接经济损失。也尽可能的杜绝了在失物招领过程中的资源浪费问题。课题完成的主要工作如下：

１、论文设计了一款基于树莓派控制的失物招领系统，采用了　HTML5、CSS、fetch、react、Javascript、Node.js、MongoDB 等技术高效的开发了失物管理平台、失物认领平台和失物认领基础数据平台；利用　CAD、计算机技术、电子技术完成了对智能失物招领箱的设计和控制，从而提出了一项改变传统失物招领方案的可行技术方案，并实现了系统的绝大部分功能，本论文的具体成果请参考附件。

２、论文所开发的失物管理平台、失物认领平台是　B/S 架构的网站服务系统，并且都是基于　MVC 的架构模式开发的，实现了支付宝第三方登录功能、投递失物功能、认领失物功能、设置失物认证信息等核心功能。

３、本系统构建了高性能的基础数据平台，基于集群的方案，部署了　MongoDB 数据库集群，为系统提供可靠的数据保障。

4、利用阿里云 ECS 和树莓派对系统核心功能测试。

## 5.2 研究展望

本论文设计了基于树莓派控制的智能失物招领系统基本能解决传统失物招领过程中的工作效率低下、找回率低、保密性差、管理分散等问题。但是仍有许多不足之处,需要完善和提升,如:

1 失物管理平台和失物认领平台界面和应用有待优化，可以通过加入缓存等技术方案，提升用户体验。

２目前设计的失物招领箱过于简单，且不能投递尺寸较大的物体，并且成本较高，对于大规模投入人群密集的环境中使用不可行，故失物招领箱的机械结构还有待改进。

3 目前系统的信息采集依靠于树莓派摄像头，拍摄的照片质量较差，虽然能够满足系统的基本需求；但是对于失物认领的准确度有比较大的影响，可以考虑使用卷积神经网络对采集的图片做一个简单的裁剪，提高图片的质量；并且目前采集的信息主要以图片为主，这并不符合实际情况，需要提出合理方案来改进。

# 致谢

时光飞快,转眼两年的研究生学习生活就要画上句点,学习生涯的结束也意味着下一段征途的开始。在这里写下“致谢”二字,不免万千感慨。回想起这两年的校园时光,需要感谢的人事太多,寥寥数语未能尽数。

首先,我要感谢我的导师袁向华老师,是她渊博的学识和平易近人的人格魅力,深深影响着我。在学术上,袁老师对前沿科技动向把握的非常准确,对新兴的前沿技术有敏锐的洞察力和浓厚的学习兴趣,为我们未来从事的专业方向作了清晰准确的指导。在日常生活上,袁老师经常鼓励和带领我们进行各种体育锻炼,在生活中也给我们做一些指导,亦师亦友。此次论文的选题、设计和实现等各个阶段的顺利进行都离不开袁老师的耐心指导,对此,我表示由衷的感谢,感谢袁老师对我悉心的指导和人生方向的指引。

同时,我还要感谢在一起学习和生活的同学朋友,是你们在学习和生活上给了我极大的帮助和鼓励,让我能够消除浮躁,专心学习专业知识,你们的关心和支持使我能够在人生道路上走的更远。

最后,感谢默默支持和关心我的家人,感谢你们多年对我的照顾,感谢你们始终如一的对我付出,毫无怨言!没有你们,我不可能顺利完成学业,塑造健全的人格。我永远都心怀感恩!我永远都爱你们!结尾,感谢室友这几年来对我的帮助和包容,愿我们友谊长存!

# 参考文献

[^1]:石延辉,李澍森,左文霞,冯宇. 智能设备的发展现状分析及前景展望[J]. 电气开关,2010,(04):11-14.

[^2]:潘学萍.电力系统数字仿真研究综述[J].江苏电机工程,2005,24(1):80-84.

[^3]:汤涌.电力系统数字仿真技术的现状与发展[J].电力系统自动化,2002,26(17):66-70.

[^14]:武宁.基于Web的在线文档分享与管理系统技术选型与预研[J].城市建设理论研究（电子版）,2014,(26):2125-2125.

[^15]:李咏.Web开发中MVC设计模式的研究与应用明[J].企业技术开发月刊,2014(6):55—56.

[^16]:江鸿飞.基于LBS和云平台的校园服务系统设计与实现[D].华中师范大学,2016.

[^17]:鲁华栋,裴祥.BS体系网络结构计算机软件开发的研究[J].信息通信,2013,(6):87-87.DOI:10.3969/j.issn.1673-1131.2013.06.053.

[^18]:李永峰.浅析企业信息管理系统采用BS架构的必然趋势[J].城市建设理论研究（电子版）,2012,(22).

[^19]:任中方,张华,闫明松等.MVC模式研究的综述[J].计算机应用研究,2004,21(10):1-4,8.DOI:10.3969/j.issn.1001-3695.2004.10.001. 

[1] 石延辉,李澍森,左文霞,冯宇. 智能设备的发展现状分析及前景展望[J]. 电气开关,2010,(04):11-14.

[2] 潘学萍.电力系统数字仿真研究综述[J].江苏电机工程,2005,24(1):80-84.

[3] 汤涌.电力系统数字仿真技术的现状与发展[J].电力系统自动化,2002,26(17):66-70.

[4] 张付仁,崔光海,姜志坚等.基于角色的用户自定义反馈系统的设计与实现[J].中国电化教育,2008,(8):106-108.DOI:10.3969/j.issn.1006-9860.2008.08.029.

[5] 宿春慧,杨方廷,刘玉明等.面向对象的可视化力反馈系统设计与实现[C].//第九届全国虚拟现实与可视化学术会议论文集.2009:201-204.

[6] 卞承荫,黄舒婷,蔡译娴等.基于学生公寓网格化管理的高校失物招领平台探析[J].太原城市职业技术学院学报,2015,(6):69-70.DOI:10.3969/j.issn.1673-0046.2015.06.031.

[7] 张蓓,庄玫,佟伟,向阳.网络环境下的高校图书馆失物招领工作探析——以清华大学图书馆为例[J]. 图书馆建设,2010,(12):89-92.

[8] 王维.基于WEB的高校网络失物招领信息管理平台开发与实现[J]. 电脑知识与技术,2014,(28):6595-6597+6610.

[9] 董伟东.失物招领系统的建立[J].计算机光盘软件与应用,2014,(01):251-252.

[10] 耿海霄,张丽梦.校园失物招领系统设计[J].硅谷,2012,(04):196.

[9] 程泽凡,杨炳旺,蔡张宇,陈志超,张红伟.基于云架构的失物招领系统[J]. 电子世界,2016,(11):131.

[11] 陈玲.遗失物招领付费之研究[J].成都理工大学学报(社会科学版),2016,(01):34-38.

[12] 卞承荫,黄舒婷,蔡译娴.基于学生公寓网格化管理的高校失物招领平台探析[J].太原城市职业技术学院学报,2015,(06):69-70.

[13] 王梓宏.基于ASP.NET的网上手机失物招领系统的设计与实现[D].北京邮电大学,2014.

[14] 江鸿飞.基于LBS和云平台的校园服务系统设计与实现[D].华中师范大学,2016.

[15] 武宁.基于Web的在线文档分享与管理系统技术选型与预研[J].城市建设理论研究（电子版）,2014,(26):2125-2125.

[16] 任中方,张华,闫明松等.MVC模式研究的综述[J].计算机应用研究,2004,21(10):1-4,8.DOI:10.3969/j.issn.1001-3695.2004.10.001. 

[17] 李咏.Web开发中MVC设计模式的研究与应用明[J].企业技术开发月刊,2014(6):55—56.

[18] 曾少宁,汪华斌.基于MVC模式的Web用户界面建模[J].测控技术,2016,35(5):95-100.DOI:10.3969/j.issn.1000-8829.2016.05.024. 

[19] 仝茵.基于ASP.NET MVC模式的软件开发架构的研究与探讨[J].中国电子科学研究院学报,2016,11(6):599-602.DOI:10.3969/j.issn.1673-5692.2016.06.007. 

[20] 刘亮,霍剑青,郭玉刚等.基于MVC的通用型模式的设计与实现[J].中国科学技术大学学报,2010,40(6):635-639.DOI:10.3969/j.issn.0253-2778.2010.06.016. 

[1] 陈仁章,孟小华.大型网络教学平台架构设计及实现[J].计算机工程与设计,2010,31(11):2455-2457,2469.

[2] 袁堂青.浅谈web信息架构设计[J].无线互联科技,2014,(12):51-51.DOI:10.3969/j.issn.1672-6944.2014.12.035.

[3] 应金航.基于MVC架构的公安部门网站内容管理系统的设计与实现[D].电子科技大学,2013.

[21] 鲁华栋,裴祥.BS体系网络结构计算机软件开发的研究[J].信息通信,2013,(6):87-87.DOI:10.3969/j.issn.1673-1131.2013.06.053.

[22] 李永峰.浅析企业信息管理系统采用BS架构的必然趋势[J].城市建设理论研究（电子版）,2012,(22).

[23] 江鸿飞.基于LBS和云平台的校园服务系统设计与实现[D].华中师范大学,2016.

[24] 赵立斌.分布式MongoDB集群高可用性的研究和性能优化[D].电子科技大学,2016.

[25] 郭星.基于Mongodb的分布式图片存储系统的研究及实现[D].中国科学院大学,2015.

[26] 孙忠芳,谭智,付海龙等.基于MongoDB集群的高性能瓦片服务器[J].中国科技信息,2015,(8):107-109.DOI:10.3969/j.issn.1001-8972.2015.08.38.

[27] 聂巍.步进电动机闭环控制系统研究[D].武汉理工大学,2014.

[28] 宋受俊.基于单片机的电机运动控制系统设计[D].西北工业大学,2006.DOI:10.7666/d.y857433.

[29] 华大龙,杨晔,潘汉怀等.步进电动机原理及其驱动电路研究[J].电脑知识与技术,2009,05(34):9841-9842.DOI:10.3969/j.issn.1009-3044.2009.34.085.

[30] 梅景登.计算机控制多个微型步进电动机的原理[J].制造技术与机床,2001,(6):34-36.DOI:10.3969/j.issn.1005-2402.2001.06.012.

[31] 陶幸辉,宋志刚.软件系统测试类型及测试用例设计[J].科技经济市场,2011,(6):3-5.DOI:10.3969/j.issn.1009-3788.2011.06.001.

[32] 李志峥,杨社堂.基于B/S结构下的软件系统测试研究[J].科技情报开发与经济,2006,16(7):232-234,251.DOI:10.3969/j.issn.1005-6033.2006.07.135.

[33] 张羽.基于BS模式课程测评系统设计与实现[D].长安大学,2012.DOI:10.7666/d.D235006.

[34] 苏祥林,陈文艺,闫洒洒等.基于树莓派的物联网开放平台[J].电子科技,2015,(9):35-37,41.DOI:10.16180/j.cnki.issn1007-7820.2015.09.009.

[35] 张永安.基于树莓派的智能家居系统[J].电子世界,2016,(15):53-53.

[36] 姚熙腾,陈恺韬,周一睿等.基于树莓派的白板自动清洁系统设计[J].数字技术与应用,2017,(1):139-140.


# 附录

失物招领箱设计简图：见附录　

失物认领平台前端: 见附录　ILAFB-m-fe

失物招领管理平台前端:　见附录　ILAFB-admin-fe

失物招领管理和失物认领平台后端: 见附录　ILAFB-node
